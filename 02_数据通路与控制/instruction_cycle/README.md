# 指令周期可视化工具

这个工具可视化展示了CPU指令周期的各个阶段，帮助理解指令是如何在CPU中执行的。

## 功能特点

- 动态可视化指令周期的各个阶段
- 支持单周期、多周期和流水线CPU模型
- 展示每个阶段的数据流动和控制信号
- 提供指令执行的详细分析
- 支持自定义指令序列

## 文件说明

- `instruction_cycle.py`: 指令周期核心实现
- `cycle_visualizer.py`: 可视化引擎
- `instruction_set.py`: 指令集定义
- `cpu_models.py`: CPU模型实现（单周期、多周期、流水线）
- `simulator.py`: 模拟器主程序
- `examples/`: 示例指令序列

## 使用方法

1. 运行模拟器：

```bash
python simulator.py [指令文件] [--model {single,multi,pipeline}]
```

2. 交互式命令：

- `step`: 单步执行一个时钟周期
- `run`: 连续执行
- `show`: 显示当前CPU状态
- `stage <名称>`: 显示特定阶段的详细信息
- `help`: 显示帮助信息
- `quit`: 退出模拟器

## 指令周期阶段

### 单周期CPU

在单周期CPU中，每条指令在一个时钟周期内完成所有阶段：

1. **取指令(Fetch)**: 从内存读取指令
2. **解码(Decode)**: 解析指令，读取寄存器
3. **执行(Execute)**: 执行ALU操作
4. **访存(Memory)**: 读写内存
5. **写回(Writeback)**: 将结果写回寄存器

### 多周期CPU

在多周期CPU中，每条指令需要多个时钟周期完成，每个周期执行一个阶段：

1. **取指令(Fetch)**: 1个周期
2. **解码(Decode)**: 1个周期
3. **执行(Execute)**: 1个周期
4. **访存(Memory)**: 0-1个周期（取决于指令类型）
5. **写回(Writeback)**: 0-1个周期（取决于指令类型）

### 流水线CPU

在流水线CPU中，多条指令可以同时执行不同的阶段：

1. **取指令(IF)**: 从内存读取指令
2. **解码(ID)**: 解析指令，读取寄存器
3. **执行(EX)**: 执行ALU操作
4. **访存(MEM)**: 读写内存
5. **写回(WB)**: 将结果写回寄存器

## 可视化效果

工具提供多种可视化效果：

- **时序图**: 展示指令执行的时间顺序
- **数据流图**: 展示数据在各个组件间的流动
- **状态图**: 展示CPU内部状态的变化
- **性能分析**: 展示CPI、吞吐量等性能指标

## 学习要点

通过这个工具，你可以学习：

1. 指令周期的基本概念和阶段
2. 不同CPU模型的工作原理
3. 指令执行过程中的数据流动
4. 控制信号如何协调各个阶段
5. 流水线技术如何提高CPU性能

## 扩展思路

1. 添加更多指令类型的支持
2. 实现流水线冒险检测和处理
3. 添加分支预测可视化
4. 实现超标量和乱序执行模型
5. 添加缓存层次结构的影响 